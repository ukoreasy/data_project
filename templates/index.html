<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ë‚´ ë°ì´í„° ë¶„ì„ í˜ì´ì§€</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; text-align: center; padding: 50px; background-color: #f4f4f4; }
        h1 { color: navy; }
        .container { width: 80%; margin: 0 auto; background: white; padding: 20px; box-shadow: 0 0 10px rgba(0,0,0,0.1); border-radius: 10px; }
        table { margin: 20px auto; border-collapse: collapse; width: 80%; }
        th, td { padding: 10px; border-bottom: 1px solid #ddd; }
        th { background-color: navy; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š í•™ìƒ ë°ì´í„° ë¶„ì„ ëŒ€ì‹œë³´ë“œ</h1>
        
        <div style="width: 70%; margin: 0 auto;">
            <canvas id="myChart"></canvas>
        </div>

        <hr>

        <h3>ğŸ“‹ ìƒì„¸ ë°ì´í„°</h3>
        <table>
            <thead>
                <tr>
                    <th>ì´ë¦„</th>
                    <th>ì ìˆ˜ (Score)</th>
                    <th>ë°ê¸° (Brightness)</th>
                </tr>
            </thead>
            <tbody>
                {% for student in students %}
                <tr>
                    <td>{{ student.name }}</td>
                    <td>{{ student.score }}</td>
                    <td><b>{{ student.brightness }}</b></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
            <hr>

        <div style="margin-top: 50px; padding: 30px; background-color: #e3f2fd; border-radius: 10px;">
            <h2>ğŸ“¸ AI ì‚¬ì§„ ë¶„ì„ê¸°</h2>
            <p>ê¶ê¸ˆí•œ ì‚¬ì§„ì„ ì—…ë¡œë“œí•˜ë©´ ë°ê¸°ë¥¼ ë¶„ì„í•´ë“œë¦½ë‹ˆë‹¤.</p>
            
            <form action="/upload" method="POST" enctype="multipart/form-data">
                <input type="file" name="file" accept="image/*" required>
                <button type="submit" style="padding: 10px 20px; background-color: navy; color: white; border: none; cursor: pointer;">
                    ë¶„ì„ ì‹œì‘ ğŸš€
                </button>
            </form>

            {% if result_brightness %}
            <div style="margin-top: 20px; color: red;">
                <h3>ğŸ” ë¶„ì„ ê²°ê³¼: ë°ê¸° {{ result_brightness }}</h3>
            </div>
            {% endif %}
        </div>
    </div>

    <script>
        // íŒŒì´ì¬ì´ ë³´ë‚¸ ë°ì´í„°ë¥¼ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë³€ìˆ˜ë¡œ ë°›ê¸°
        const names = {{ names | tojson }};
        const scores = {{ scores | tojson }};
        const brightness = {{ brightness_values | tojson }};

        const ctx = document.getElementById('myChart').getContext('2d');
        const myChart = new Chart(ctx, {
            type: 'bar', // ê·¸ë˜í”„ ì¢…ë¥˜ (bar: ë§‰ëŒ€, line: êº¾ì€ì„ )
            data: {
                labels: names, // Xì¶•: ì´ë¦„
                datasets: [
                    {
                        label: 'í•™ìƒ ì ìˆ˜',
                        data: scores,
                        backgroundColor: 'rgba(54, 162, 235, 0.6)', // íŒŒë€ìƒ‰
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    },
                    {
                        label: 'ì´ë¯¸ì§€ ë°ê¸° (AI ë¶„ì„)',
                        data: brightness,
                        type: 'line', // ë°ê¸°ëŠ” êº¾ì€ì„ ìœ¼ë¡œ í‘œí˜„! (í˜¼í•© ê·¸ë˜í”„)
                        borderColor: 'rgba(255, 99, 132, 1)', // ë¹¨ê°„ìƒ‰
                        borderWidth: 3,
                        yAxisID: 'y1' // ì˜¤ë¥¸ìª½ ì¶• ì‚¬ìš©
                    }
                ]
            },
            options: {
                scales: {
                    y: { beginAtZero: true, position: 'left' },
                    y1: { beginAtZero: true, position: 'right', grid: { drawOnChartArea: false } }
                }
            }
        });
    </script>
</body>
</html>